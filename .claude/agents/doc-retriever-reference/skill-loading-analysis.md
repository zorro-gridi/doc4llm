# æŠ€èƒ½åŠ è½½ç­–ç•¥æ·±åº¦åˆ†æï¼šè´¨é‡ vs æ€§èƒ½

## ğŸ¯ **æ ¸å¿ƒé—®é¢˜**

**æ‚¨çš„ç›®æ ‡**: "å¸Œæœ›æ£€ç´¢éµå®ˆä¸€å¥—å®Œæ•´çš„æŠ€èƒ½å·¥ä½œæµï¼Œä¿è¯æ£€ç´¢è´¨é‡"

åŸºäºè¿™ä¸ªæ˜ç¡®çš„è´¨é‡ä¼˜å…ˆç›®æ ‡ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°è¯„ä¼°æŠ€èƒ½åŠ è½½ç­–ç•¥ã€‚

## ğŸ“Š **è¯¦ç»†å¯¹æ¯”åˆ†æ**

### 1. **å·¥ä½œæµå®Œæ•´æ€§ä¿è¯**

#### âœ… **é¢„åŠ è½½æ¨¡å¼ (æ¨è)**
```yaml
skills:
  - md-doc-query-optimizer    # å§‹ç»ˆå¯ç”¨
  - md-doc-searcher          # å§‹ç»ˆå¯ç”¨  
  - md-doc-reader            # å§‹ç»ˆå¯ç”¨
  - md-doc-processor         # å§‹ç»ˆå¯ç”¨
```

**ä¼˜åŠ¿:**
- ğŸ”’ **å¼ºåˆ¶æ‰§è¡Œå››é˜¶æ®µå·¥ä½œæµ**: æ— æ³•è·³è¿‡ä»»ä½•é˜¶æ®µ
- ğŸ¯ **è´¨é‡ä¸€è‡´æ€§**: æ¯æ¬¡æ£€ç´¢éƒ½éµå¾ªç›¸åŒçš„é«˜è´¨é‡æµç¨‹
- ğŸ›¡ï¸ **é›¶å¤±è´¥é£é™©**: æŠ€èƒ½å§‹ç»ˆåœ¨ä¸Šä¸‹æ–‡ä¸­ï¼Œæ— è°ƒç”¨å¤±è´¥
- ğŸ“‹ **æ ‡å‡†åŒ–è¾“å‡º**: ä¿è¯è¾“å‡ºæ ¼å¼å’Œå¼•ç”¨çš„ä¸€è‡´æ€§

#### âš ï¸ **æŒ‰éœ€åŠ è½½æ¨¡å¼**
```yaml
skills: []  # è¿è¡Œæ—¶è°ƒç”¨
```

**é£é™©:**
- ğŸš¨ **å·¥ä½œæµä¸­æ–­é£é™©**: æŠ€èƒ½è°ƒç”¨å¤±è´¥å¯¼è‡´é˜¶æ®µè·³è¿‡
- ğŸ“‰ **è´¨é‡ä¸ä¸€è‡´**: ä¸åŒæŸ¥è¯¢å¯èƒ½èµ°ä¸åŒçš„ç®€åŒ–æµç¨‹
- ğŸ”„ **å¤æ‚é”™è¯¯å¤„ç†**: éœ€è¦ä¸ºæ¯ä¸ªæŠ€èƒ½è°ƒç”¨ç¼–å†™å¤±è´¥å¤„ç†é€»è¾‘
- âš¡ **æ€§èƒ½ä¸ç¡®å®š**: æŠ€èƒ½åŠ è½½æ—¶é—´ä¸å¯é¢„æµ‹

### 2. **è´¨é‡ä¿è¯æœºåˆ¶å¯¹æ¯”**

| è´¨é‡ç»´åº¦ | é¢„åŠ è½½æ¨¡å¼ | æŒ‰éœ€åŠ è½½æ¨¡å¼ |
|----------|------------|--------------|
| **æŸ¥è¯¢ä¼˜åŒ–** | âœ… 100% æ‰§è¡Œ | âš ï¸ å¯èƒ½è·³è¿‡ |
| **æ–‡æ¡£å‘ç°** | âœ… å®Œæ•´æœç´¢ | âš ï¸ å¯èƒ½é™çº§ |
| **å†…å®¹æå–** | âœ… æ ‡å‡†æµç¨‹ | âš ï¸ å¯èƒ½ç®€åŒ– |
| **åå¤„ç†** | âœ… æ™ºèƒ½å‹ç¼© | âš ï¸ å¯èƒ½çœç•¥ |
| **å¼•ç”¨å®Œæ•´æ€§** | âœ… å¼ºåˆ¶åŒ…å« | âš ï¸ å¯èƒ½ç¼ºå¤± |

### 3. **å®é™…æ€§èƒ½å½±å“åˆ†æ**

#### **å¯åŠ¨æ—¶é—´å¯¹æ¯”**
```
é¢„åŠ è½½æ¨¡å¼:
â”œâ”€â”€ æŠ€èƒ½åŠ è½½: 6-8s
â”œâ”€â”€ ä¸Šä¸‹æ–‡å‡†å¤‡: 2-3s  
â””â”€â”€ æ€»å¯åŠ¨æ—¶é—´: 8-11s

æŒ‰éœ€åŠ è½½æ¨¡å¼:
â”œâ”€â”€ åˆå§‹å¯åŠ¨: 2-3s
â”œâ”€â”€ è¿è¡Œæ—¶æŠ€èƒ½è°ƒç”¨: 1-2s Ã— 4ä¸ªæŠ€èƒ½ = 4-8s
â””â”€â”€ æ€»æ‰§è¡Œæ—¶é—´: 6-11s (å®é™…å¯èƒ½æ›´é•¿)
```

**ç»“è®º**: å®é™…æ€»æ—¶é—´å·®å¼‚ä¸å¤§ï¼Œä½†é¢„åŠ è½½æä¾›æ›´å¯é¢„æµ‹çš„æ€§èƒ½ã€‚

#### **å†…å­˜ä½¿ç”¨ä¼˜åŒ–ç­–ç•¥**

å³ä½¿ä½¿ç”¨é¢„åŠ è½½ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼˜åŒ–å†…å­˜ï¼š

1. **æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†**
   ```yaml
   optimization:
     skill_loading: "progressive"    # æ¸è¿›å¼åŠ è½½
     memory_management: "smart"      # æ™ºèƒ½å†…å­˜ç®¡ç†
     context_compression: "auto"     # è‡ªåŠ¨å‹ç¼©éæ´»è·ƒæŠ€èƒ½
   ```

2. **æŒ‰éœ€æ¿€æ´»æœºåˆ¶**
   ```python
   # æŠ€èƒ½é¢„åŠ è½½ä½†æŒ‰éœ€æ¿€æ´»
   def activate_skill_when_needed(skill_name, phase):
       if not skill_contexts[skill_name].is_active:
           skill_contexts[skill_name].activate()
       return skill_contexts[skill_name]
   ```

## ğŸ† **æœ€ç»ˆæ¨èï¼šè´¨é‡ä¼˜å…ˆçš„é¢„åŠ è½½ç­–ç•¥**

### **æ¨èé…ç½®**

```yaml
---
name: doc-retriever
model: sonnet
skills:
  # æ ¸å¿ƒå·¥ä½œæµæŠ€èƒ½ - é¢„åŠ è½½ä»¥ä¿è¯æ£€ç´¢è´¨é‡
  - md-doc-query-optimizer    # Phase 0: æŸ¥è¯¢ä¼˜åŒ–
  - md-doc-searcher          # Phase 1: æ–‡æ¡£å‘ç°  
  - md-doc-reader            # Phase 2: å†…å®¹æå–
  - md-doc-processor         # Phase 3: åå¤„ç†
optimization:
  workflow_enforcement: "strict"      # ä¸¥æ ¼æ‰§è¡Œå››é˜¶æ®µ
  quality_checkpoints: "enabled"     # å¯ç”¨è´¨é‡æ£€æŸ¥ç‚¹
  memory_management: "smart"          # æ™ºèƒ½å†…å­˜ç®¡ç†
---
```

### **è´¨é‡ä¿è¯å·¥ä½œæµ**

```
ç”¨æˆ·æŸ¥è¯¢
    â†“
Phase 0: æŸ¥è¯¢ä¼˜åŒ– (md-doc-query-optimizer)
    â”œâ”€â”€ âœ… æŠ€èƒ½å¯ç”¨æ€§: 100% ä¿è¯
    â”œâ”€â”€ ğŸ¯ è¾“å‡ºè´¨é‡: 3-5ä¸ªä¼˜åŒ–æŸ¥è¯¢
    â””â”€â”€ ğŸ“Š è´¨é‡æ£€æŸ¥: æŸ¥è¯¢å¤æ‚åº¦å’Œè¦†ç›–åº¦éªŒè¯
    â†“
Phase 1: æ–‡æ¡£å‘ç° (md-doc-searcher)  
    â”œâ”€â”€ âœ… æŠ€èƒ½å¯ç”¨æ€§: 100% ä¿è¯
    â”œâ”€â”€ ğŸ¯ è¾“å‡ºè´¨é‡: å®Œæ•´çš„æ–‡æ¡£åˆ—è¡¨ + è¦†ç›–åº¦åˆ†æ
    â””â”€â”€ ğŸ“Š è´¨é‡æ£€æŸ¥: æœç´¢ç»“æœç›¸å…³æ€§éªŒè¯
    â†“
Phase 2: å†…å®¹æå– (md-doc-reader)
    â”œâ”€â”€ âœ… æŠ€èƒ½å¯ç”¨æ€§: 100% ä¿è¯  
    â”œâ”€â”€ ğŸ¯ è¾“å‡ºè´¨é‡: å®Œæ•´å†…å®¹ + å…ƒæ•°æ®
    â””â”€â”€ ğŸ“Š è´¨é‡æ£€æŸ¥: å†…å®¹å®Œæ•´æ€§å’Œè¡Œæ•°ç»Ÿè®¡
    â†“
Phase 2.5: æ¡ä»¶æ£€æŸ¥ (doc-retriever å†³ç­–)
    â”œâ”€â”€ ğŸ§  æ™ºèƒ½åˆ¤æ–­: åŸºäºå†…å®¹å¤§å°å’Œç”¨æˆ·æ„å›¾
    â””â”€â”€ ğŸ“‹ å†³ç­–è®°å½•: è®°å½•å¤„ç†å†³ç­–å’ŒåŸå› 
    â†“
Phase 3: åå¤„ç† (md-doc-processor) [æ¡ä»¶æ€§]
    â”œâ”€â”€ âœ… æŠ€èƒ½å¯ç”¨æ€§: 100% ä¿è¯
    â”œâ”€â”€ ğŸ¯ è¾“å‡ºè´¨é‡: æ™ºèƒ½å‹ç¼©æˆ–å®Œæ•´è¾“å‡º
    â””â”€â”€ ğŸ“Š è´¨é‡æ£€æŸ¥: å¼•ç”¨å®Œæ•´æ€§å’Œæ ¼å¼éªŒè¯
    â†“
AOP-FINAL è¾“å‡º
    â”œâ”€â”€ ğŸ”’ è¾“å‡ºä¿æŠ¤: é˜²æ­¢åç»­ä¿®æ”¹
    â”œâ”€â”€ ğŸ“š å®Œæ•´å¼•ç”¨: æºURL + æ–‡æ¡£è·¯å¾„
    â””â”€â”€ âœ¨ è´¨é‡ä¿è¯: ç¬¦åˆæ‰€æœ‰è´¨é‡æ ‡å‡†
```

## ğŸ¯ **è´¨é‡ä¼˜åŠ¿æ€»ç»“**

### **é¢„åŠ è½½æ¨¡å¼çš„è´¨é‡ä¿è¯**

1. **100% å·¥ä½œæµæ‰§è¡Œç‡**
   - æ— æŠ€èƒ½è°ƒç”¨å¤±è´¥é£é™©
   - æ¯ä¸ªæŸ¥è¯¢éƒ½ç»è¿‡å®Œæ•´çš„å››é˜¶æ®µå¤„ç†
   - ä¿è¯è¾“å‡ºè´¨é‡çš„ä¸€è‡´æ€§

2. **æ ‡å‡†åŒ–è´¨é‡æ£€æŸ¥**
   - æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„è´¨é‡æ ‡å‡†
   - è‡ªåŠ¨åŒ–è´¨é‡éªŒè¯æœºåˆ¶
   - è´¨é‡é—®é¢˜çš„æ—©æœŸå‘ç°å’Œå¤„ç†

3. **å¯é¢„æµ‹çš„æ€§èƒ½**
   - å¯åŠ¨æ—¶é—´å›ºå®šä¸”å¯é¢„æµ‹
   - æ— è¿è¡Œæ—¶æŠ€èƒ½åŠ è½½å»¶è¿Ÿ
   - ç”¨æˆ·ä½“éªŒä¸€è‡´æ€§

4. **ç®€åŒ–çš„é”™è¯¯å¤„ç†**
   - ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘é”™è¯¯
   - æ— éœ€å¤„ç†åŸºç¡€è®¾æ–½å¤±è´¥
   - æ›´å¯é çš„ç³»ç»Ÿè¡Œä¸º

## ğŸ“ˆ **æ€§èƒ½ä¼˜åŒ–å»ºè®®**

å³ä½¿é€‰æ‹©é¢„åŠ è½½ï¼Œæˆ‘ä»¬ä»å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼˜åŒ–æ€§èƒ½ï¼š

### 1. **æ™ºèƒ½å†…å­˜ç®¡ç†**
```python
# æŠ€èƒ½ä¸Šä¸‹æ–‡æ™ºèƒ½ç®¡ç†
class SmartSkillManager:
    def __init__(self):
        self.active_skills = {}
        self.memory_threshold = 200MB
    
    def optimize_memory(self):
        if self.get_memory_usage() > self.memory_threshold:
            self.compress_inactive_skills()
            self.cleanup_temporary_data()
```

### 2. **æ¸è¿›å¼æ¿€æ´»**
```python
# æŠ€èƒ½æŒ‰éœ€æ¿€æ´»ä½†å§‹ç»ˆå¯ç”¨
def execute_phase(phase_name, skill_name, input_data):
    skill = self.ensure_skill_active(skill_name)
    result = skill.execute(input_data)
    self.record_quality_metrics(phase_name, result)
    return result
```

### 3. **ç¼“å­˜ä¼˜åŒ–**
```python
# æŸ¥è¯¢ç»“æœç¼“å­˜
@lru_cache(maxsize=100)
def cached_query_optimization(query_hash):
    return md_doc_query_optimizer.optimize(query)
```

## ğŸ **æœ€ç»ˆç»“è®º**

**å¯¹äºæ‚¨çš„è´¨é‡ä¼˜å…ˆç›®æ ‡ï¼Œå¼ºçƒˆæ¨èé¢„åŠ è½½æ¨¡å¼**

### **æ ¸å¿ƒç†ç”±**:

1. **è´¨é‡ä¿è¯**: 100% å·¥ä½œæµæ‰§è¡Œï¼Œæ— è´¨é‡å¦¥å
2. **ä¸€è‡´æ€§**: æ¯æ¬¡æ£€ç´¢éƒ½éµå¾ªç›¸åŒçš„é«˜æ ‡å‡†æµç¨‹  
3. **å¯é æ€§**: é›¶æŠ€èƒ½è°ƒç”¨å¤±è´¥é£é™©
4. **å¯é¢„æµ‹æ€§**: å›ºå®šçš„æ€§èƒ½ç‰¹å¾å’Œç”¨æˆ·ä½“éªŒ
5. **ç®€åŒ–ç»´æŠ¤**: æ›´å°‘çš„é”™è¯¯å¤„ç†å¤æ‚æ€§

### **æ€§èƒ½ä¼˜åŒ–**:
é€šè¿‡æ™ºèƒ½å†…å­˜ç®¡ç†å’Œæ¸è¿›å¼æ¿€æ´»ï¼Œå¯ä»¥åœ¨ä¿è¯è´¨é‡çš„åŒæ—¶ä¼˜åŒ–æ€§èƒ½è¡¨ç°ã€‚

**æœ€ç»ˆè¯„ä¼°**: é¢„åŠ è½½æ¨¡å¼æ›´ç¬¦åˆæ‚¨çš„"ä¿è¯æ£€ç´¢è´¨é‡"ç›®æ ‡ï¼Œæ˜¯æ­£ç¡®çš„é€‰æ‹©ã€‚